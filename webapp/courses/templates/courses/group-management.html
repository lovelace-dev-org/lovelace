{% extends 'courses/base.html' %}

{% load i18n %}
{% load static %}
{% load course_tags %}

{% block extra-static %}
<script src="{% static 'courses/groups.js' %}"></script>
{% endblock %}

{% block breadcrumb-links %}
  <li><a href="{% url 'courses:index' %}">{% trans 'Courses' %}</a></li>
  <div class="separator">»</div>
  <li><a href="{% url 'courses:course' course instance %}">{{ course.name }}&nbsp;/&nbsp;{{ instance_name }}</a></li>
  <div class="separator">»</div>
  {% if group %}
    <li>{% trans 'Group Management' %}</li>
  {% endif %}
{% endblock %}

{% block page-content %}
    <h1>{% trans 'Manage groups' %}</h1>
    
    <table class="full-width">
        <thead>
        
        </thead>
        <tbody>
            {% for group in groups %}
                <tr class="section-header">
                    <td colspan="2">
                        <input class="collapsed" 
                               type="text" 
                               value="{{ group.name }}"
                               onchange="grp.submit_rename(event, this);"
                               data-url="{% url 'courses:rename_group' course instance group %}"
                               data-csrf="{{ csrf_token }}">
                        </input>
                        <span>{{ group.name }}</span>
                    </td>
                    <td>
                        {% if is_responsible %}
                            {% trans 'supervisor:' %}
                            {% supervisor_select group %}
                        {% endif %}
                    </td>
                    <td class="actions-cell">
                        <button type="button"
                                class="staff-base-button edit-button"
                                title="{% trans 'Rename this group' %}"
                                onclick="grp.toggle_rename(event, this);">
                        </button>
                        <button type="button"
                                class="staff-base-button add-button"
                                title="{% trans 'Add a member to this group' %}"
                                onclick="grp.fetch_form(event, this);"
                                data-url="{% url 'courses:add_member' course instance group %}">+
                        </button>
                        <button type="button"
                                class="staff-base-button delete-button"
                                title="{% trans 'Remove this group' %}"
                                onclick="grp.remove_group(event, this);"
                                data-url="{% url 'courses:remove_group' course instance group %}"
                                data-csrf="{{ csrf_token }}">X
                        </button>
                    </td>
                </tr>
                {% for member in group.members.get_queryset %}
                    <tr class="group-member">
                        <td>{{ member.last_name }}</td>
                        <td>{{ member.first_name }}</td>
                        <td>{{ member.email }}</td>
                        <td class="actions-cell">
                            <button type="button"
                                    class="staff-base-button delete-button"
                                    title="{% trans 'Remove this member' %}"
                                    onclick="grp.remove_member(event, this);"
                                    data-url="{% url 'courses:remove_member' course instance group member %}"
                                    data-csrf="{{ csrf_token }}">X
                            </button>
                        </td>
                    </tr>
                {% endfor %}
            {% endfor %}
        </tbody>
        <tfoot>
            <tr>
                <td colspan="4">
                    <button type="button"
                            class="staff-base-button add-button"
                            title="{% trans 'Create a new group' %}"
                            onclick="grp.fetch_form(event, this);"
                            data-url="{% url 'courses:create_group' course instance %}">+
                    </button>
                </td>
            </tr>
        </tfoot>
    </table>
{% endblock %}
        
                    
