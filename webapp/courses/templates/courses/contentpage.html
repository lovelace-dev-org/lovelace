{% extends 'courses/base.html' %}
{% load static %}
{% load i18n %}
{% load course_tags %}

{% block page-title %}
{% if sandboxed %}
  {{ content.name }}
{% else %}
  {{ content.name }} – {{ course.name }}
{% endif %}
{% endblock %}

{% block breadcrumb-links %}
  <li><a href="{% url 'courses:index' %}">{% trans 'Courses' %}</a></li>
  {% if not sandboxed %}
    <div class="separator">»</div>
    <li>
      <a href="{% url 'courses:course' course instance %}">
        {{ course_name }}&nbsp;/&nbsp;{{ instance.name }}
      </a>
    </li>
    <div class="separator">»</div>
    <li>
      <a href="{% url 'courses:content' course instance content %}">{{ content.name }}</a>
    </li>
  {% endif %}
{% endblock %}

{% block course-stats-link %}
  {% if not sandboxed %}
    <a href="{% url 'stats:users_course' course instance %}">{% trans 'Course statistics' %}</a>
  {% endif %}
{% endblock %}

{% block course-completion-link %}
  {% if not sandboxed %}
    <a href="{% url 'teacher_tools:completion' course instance %}">
      {% trans 'Course completion' %}
    </a>
  {% endif %}
{% endblock %}

{% block course-enrollments-link %}
  {% if not sandboxed %}
    <a href="{% url 'teacher_tools:manage_enrollments' course instance %}">
      {% trans 'Manage enrollments' %}
    </a>
  {% endif %}
{% endblock %}

{% block revision-info %}
  {% if revision and revision > 0 and course_staff %}
    <div class="revision-info">This is an old revision № {{ revision }} of this page!</div>
  {% endif %}
{% endblock %}

{% block page-content %}
{% if not content.is_answerable %}
  {% if course_staff %}
    {% content_meta %}
  {% endif %}
  {% for block_type, block_data, line_idx, line_count in content_blocks %}
    {% if course_staff and revision is None and block_type != "cleanup" %}
      <span>
        {% if block_type not in uneditable_markups %}
          <a class="staff-only collapsed"
            href="{{ edit_content_url }}"
            onclick="editing.show_widget_panel(event, this)"
            data-querystring="line={{ line_idx }}&block={{ block_type }}&size={{ line_count }}"
            data-csrf="{{ csrf_token }}"><img src="{% static 'courses/edit.png' %}"></a>
        {% endif %}
        <a class="staff-only collapsed"
          href="{{ delete_content_url }}"
          onclick="editing.show_widget_panel(event, this)"
          data-querystring="line={{ line_idx }}&block={{ block_type }}&size={{ line_count }}"
          data-csrf="{{ csrf_token }}"><img src="{% static 'courses/delete-16.png' %}"></a>
        <a class="staff-only collapsed"
          href="{{ add_content_url }}"
          onclick="editing.show_widget_panel(event, this)"
          data-querystring="line={{ line_idx }}&size={{ line_count }}"
          data-csrf="{{ csrf_token }}"><img src="{% static 'courses/expand-16.png' %}"></a>
      </span>
    {% endif %}
    {% if block_type == "calendar" %}
      {% calendar block_data %}
    {% elif block_type == "embedded" %}
      {% embed_frame block_data %}
    {% else %}
      {{ block_data|safe }}
    {% endif %}
  {% endfor %}
  
  {% block feedback %}
    {% feedbacks %}
  {% endblock %}

{% else %}
  {% if content.content_type == "MULTIPLE_CHOICE_EXERCISE" %}
    {% multiple_choice_exercise %}
  {% elif content.content_type == "CHECKBOX_EXERCISE" %}
    {% checkbox_exercise %}
  {% elif content.content_type == "TEXTFIELD_EXERCISE" %}
    {% textfield_exercise %}
  {% elif content.content_type == "FILE_UPLOAD_EXERCISE" %}
    {% file_upload_exercise %}
  {% endif %}
{% endif %}

{% endblock %}


